#!/usr/bin/env bash

# TODO git conflicts
#   sqldiff 0 to A
#   sqldiff 0 to B
#   apply sqldiff `0 to A` to B
#   apply sqldiff `0 to B` to A
#   if new A and new B are different then there was a conflict
#   then:
#       set conflict markers/placeholders in record (don't break sqlite db)
#       maybe return a select query of the keys

# possible tools:
# git diff --no-index ... => don't need a git tree

trunk="$(dirname $0)"

. $trunk/util.sh

sqldiff="$1"
ancestor="$2"
local="$3"
remote="$4"
marker="$5"
placeholder="$6"

ancestor2remoteDiff=$(diffDb "$sqldiff" "$ancestor" "$remote")
printErr $ancestor2remoteDiff
sqlite3 "$local" "$ancestor2remoteDiff"

#echo "marker='$marker'"
#echo "placeholder='$placeholder'"
#exit 1
